{% extends "global/Page.html" %}
{% load staticfiles otree %}
{% load staticfiles %}
{% load otree static %}

{% block title %}
    The Choice List
{% endblock %}

{% block content %}
    <p style="text-align: center;">Today is <b><span class="date"></span></b> (DD-MM-YYYY, DD = day of the month, MM = month, YYYY = year).</p>
    <p>If you were given the choice between the following two options to receive money, which one would you prefer?</p>
    <p>Note: Money or date will change in subsequent questions.</p>

<div class="otdm__choices-selection">

    <table class="otdm__choices-table table table-bordered table-striped" style="table-layout: fixed;">
        <thead>
        <tr class="text-center">
            <th style="color: red;">Option A</th>
            <th style="color: red;" width="75">A</th>
            <th style="color: blue;" width="75">B</th>
            <th style="color: blue;">Option B</th>
        </tr>
        </thead>
        <tbody class="small">
        {% for day, rev_day in day_gain %}
        <tr>
            <td class="text-center" style="color: red;">
                Receiving $<span class="receiving_amount"></span> on <span class="date"></span>
            </td>

<script>
// JavaScript code to update the values
var today = new Date();
var year = today.getFullYear();
var month = today.getMonth() + 1; // 月份从 0 开始，需要加 1
var day = today.getDate();
var formattedDate = day + '-' + month + '-' + year;

// 获取所有包含 class="date" 的元素
var dateElements = document.querySelectorAll('.date');

// 更新所有日期元素的内容
dateElements.forEach(function(element) {
    element.textContent = formattedDate;
});

var receivingAmount = 1; // 初始金额

// 获取所有包含 class="receiving_amount" 的元素
var amountElements = document.querySelectorAll('.receiving_amount');

// 更新每个元素的金额
amountElements.forEach(function(element) {
    // 更新HTML中的金额
    element.textContent = receivingAmount;

    // 递增金额（每行增加1）
    receivingAmount += 1;
});
</script>

            <td class="text-center otdm__choice-cell">
                <label>
                    <input type="radio" name="otdm__option_day{{forloop.counter}}"
                           class="otdm__choice-input"
                           value="A" data-day="{{ day }}" data-index="{{ forloop.counter }}">
                </label>
            </td>
            <td class="text-center otdm__choice-cell">
                <label>
                    <input type="radio" name="otdm__option_day{{forloop.counter}}"
                           class="otdm__choice-input"
                           value="B" data-day="{{ day }}" data-index="{{ forloop.counter }}">
                </label>
            </td>
            <td style="color: blue;" class="text-center">
                Receiving $30 on <span class="receiving_date"></span>
<script>
    // JavaScript code to display fixed values
    var daysInFuture = 30; // 固定日期为 15 天后
    var currentDate = new Date();
    var futureDate = new Date(currentDate);
    futureDate.setDate(currentDate.getDate() + daysInFuture);


    // 获取所有包含 class="receiving_date" 的元素
    var dateElements = document.querySelectorAll('.receiving_date');

    // 更新每个元素的日期（固定为 15 天后）
    dateElements.forEach(function(element) {
        // 更新HTML中的日期
        element.textContent = formatDate(futureDate);
    });

    function formatDate(date) {
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var day = date.getDate();
        return day + "-" + month + "-" + year;
    }
</script>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>

    <div class="otdm__waiting">
        You have to select an option above to continue.
    </div>
</div>

<div class="otdm__confirm-button-wrapper">
    <button class="btn btn-primary otdm__confirm-button" type="button">
        Confirm
    </button>
</div>

<div class="otdm__player-confirmation">
    <h5><span style="color: red;">How certain</span> are you that you prefer to</h5>

    <p class="text-center">
        <span class="otdm__confirmation-either"></span>
    </p>

    <p class="text-center">
        <b>rather than</b>
    </p>

    <p class="text-center">
        <span class="otdm__confirmation-other"></span>
    </p>

<div class="certainty-question" style="margin-bottom: 20px;"> <!-- 增加了底部外边距 -->
    <div class="percentage-slider">
        {% formfield player.cert41l label="" %}
    </div>
    <div class="slider-labels" style="display: flex; justify-content: space-between; width: 100%; padding: 0 10px; font-weight: bold;"> <!-- 加粗文本 -->
        <span class="slider-label-left">very uncertain</span>
        <span class="slider-label-right">completely certain</span>
    </div>
</div>

    {% next_button %}
</div>

<input class="otdm__value" type="hidden" name="{{ var_name }}">

{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{% static 'otdm/styles/choices.css' %}"/>
{% endblock %}

{% block scripts %}
<script src="{% static 'otdm/scripts/choices.js' %}"></script>
{% endblock %}
